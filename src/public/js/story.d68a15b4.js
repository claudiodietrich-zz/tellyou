(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["story"],{2945:function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("router-view")},a=[],i=s("2877"),n={},o=Object(i["a"])(n,r,a,!1,null,null,null);e["default"]=o.exports},"2c59":function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"section"},[s("div",{staticClass:"container"},[s("h1",{staticClass:"title"},[t._v("\n      "+t._s(t.story.title)+"\n    ")]),s("status-tag",{attrs:{status:t.story.status}}),s("div",{staticClass:"box"},[s("h1",{staticClass:"is-size-4 m-b-4"},[t._v("\n        "+t._s(t.$t("story.objective"))+"\n      ")]),s("p",[t._v("\n        "+t._s(t.story.objective)+"\n      ")]),s("h1",{staticClass:"is-size-4 m-t-4 m-b-4"},[t._v("\n        "+t._s(t.$t("story.stages"))+"\n      ")]),s("div",{staticClass:"timeline"},t._l(t.orderedStages,function(e,r){return s("div",{key:e._id,staticClass:"timeline-item"},[s("div",{staticClass:"timeline-marker is-32x32",class:[0===e.events.length?"is-danger":"is-primary"]}),s("b-tooltip",{attrs:{label:e.description,position:"is-right",animated:"",multilined:""}},[s("div",{staticClass:"timeline-content"},[s("router-link",{staticClass:"heading has-badge-rounded",attrs:{to:{name:"stageView",params:{storyId:t.story._id,stageId:e._id}},"data-badge":e.events.filter(function(e){return!e.readBy.includes(t.$session.get("userId"))}).length}},[t._v("\n                "+t._s(r+1+" - "+e.name)+"\n              ")])],1)])],1)}),0)])],1)])},a=[],i=(s("96cf"),s("3b8d")),n=s("0517"),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("b-taglist",{attrs:{attached:""}},[s("b-tag",{attrs:{size:t.size,rounded:t.rounded,ellipsis:t.ellipsis,tabstop:t.tabstop}},[t._v("status")]),s("b-tag",{attrs:{type:t.type,size:t.size,rounded:t.rounded,ellipsis:t.ellipsis,tabstop:t.tabstop}},[t._v(t._s(t.statusToText))])],1)},l=[],c={props:{size:{type:String,default:""},rounded:{type:Boolean,default:!1},ellipsis:{type:Boolean,default:!1},tabstop:{type:Boolean,default:!1},status:{required:!0}},computed:{type:function(){switch(this.status){case 0:return"is-primary";case 1:return"is-warning";case 2:return"is-info";case 3:return"is-success";default:return"is-primary"}},statusToText:function(){switch(this.status){case 0:return this.$t("story.status.created");case 1:return this.$t("story.status.inReview");case 2:return this.$t("story.status.revised");case 3:return this.$t("story.status.finished");default:return""}}}},u=c,d=s("2877"),p=Object(d["a"])(u,o,l,!1,null,null,null),h=p.exports,v={mixins:[n["a"]],components:{StatusTag:h},computed:{story:function(){return this.$store.state.story.story},orderedStages:function(){return this.$store.getters["story/orderedStages"]}},beforeCreate:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e=this.$route.params.storyId,t.next=4,this.$store.dispatch("story/findById",e);case 4:t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),this.errorHandler(t.t0.response);case 9:case"end":return t.stop()}},t,this,[[0,6]])}));function e(){return t.apply(this,arguments)}return e}()},f=v,b=(s("f474"),Object(d["a"])(f,r,a,!1,null,"2e741c35",null));e["default"]=b.exports},"97ae":function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"section"},[s("div",{staticClass:"container"},[s("h1",{staticClass:"title"},[t._v("\n      "+t._s(t.$t("default.label.new.female",{arg:t.$tc("story.label",1)}))+"\n    ")]),s("div",{staticClass:"box"},[s("div",{directives:[{name:"show",rawName:"v-show",value:0===t.currentStep,expression:"currentStep === 0"}]},[s("h1",{staticClass:"is-size-4 m-b-4"},[t._v("\n          "+t._s(t.$t("view.story.create.form.title.story"))+"\n        ")]),s("b-field",{attrs:{label:t.$t("view.story.create.form.label.title"),type:{"is-danger":t.$v.title.$error},message:[!t.$v.title.required&&t.$v.title.$error?t.$t("default.error.field.is.required"):""]}},[s("b-input",{model:{value:t.title,callback:function(e){t.title="string"===typeof e?e.trim():e},expression:"title"}})],1),s("b-field",{attrs:{label:t.$t("view.story.create.form.label.keywords"),message:t.$t("view.story.create.form.message.keywords")}},[s("b-taginput",{attrs:{type:"is-primary"},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}})],1),s("b-field",{attrs:{label:t.$t("view.story.create.form.label.objective")}},[s("b-input",{attrs:{type:"textarea"},model:{value:t.objective,callback:function(e){t.objective="string"===typeof e?e.trim():e},expression:"objective"}})],1)],1),s("div",{directives:[{name:"show",rawName:"v-show",value:1===t.currentStep,expression:"currentStep === 1"}]},[s("h1",{staticClass:"is-size-4 m-b-4"},[t._v("\n          "+t._s(t.$t("view.story.create.form.title.author"))+"\n        ")]),s("b-field",{attrs:{label:t.$t("view.story.create.form.label.leader")}},[s("b-input",{attrs:{value:t.leader.name,disabled:""}})],1),s("b-field",{attrs:{label:t.$t("view.story.create.form.label.revisors"),message:t.$t("view.story.create.form.message.revisors")}},[s("b-taginput",{attrs:{data:t.filteredUsers,"allow-new":!1,"open-on-focus":!0,placeholder:t.$t("default.label.add",{arg:t.$t("story.revisor")}),field:"name",type:"is-primary",autocomplete:""},on:{typing:t.getUsers,add:t.addReviewer,remove:t.removeAuthor},scopedSlots:t._u([{key:"default",fn:function(e){return[s("strong",[t._v(t._s(e.option.name))]),t._v(" ("+t._s(e.option.email)+")\n            ")]}}]),model:{value:t.reviewers,callback:function(e){t.reviewers=e},expression:"reviewers"}})],1),s("b-field",{attrs:{label:t.$t("view.story.create.form.label.storytellers"),message:t.$t("view.story.create.form.message.storytellers")}},[s("b-taginput",{attrs:{data:t.filteredUsers,"allow-new":!1,"open-on-focus":!0,placeholder:t.$t("default.label.add",{arg:t.$t("story.storyteller")}),field:"name",type:"is-primary",autocomplete:""},on:{typing:t.getUsers,add:t.addStoryteller,remove:t.removeAuthor},scopedSlots:t._u([{key:"default",fn:function(e){return[s("strong",[t._v(t._s(e.option.name))]),t._v(" ("+t._s(e.option.email)+")\n            ")]}}]),model:{value:t.storytellers,callback:function(e){t.storytellers=e},expression:"storytellers"}})],1)],1),s("div",{directives:[{name:"show",rawName:"v-show",value:2===t.currentStep,expression:"currentStep === 2"}]},[s("h1",{staticClass:"is-size-4 m-b-2"},[t._v("\n          "+t._s(t.$t("view.story.create.form.title.archetypes"))+"\n        ")]),s("p",{staticClass:"m-b-4",domProps:{innerHTML:t._s(t.$t("view.story.create.form.description.archetypes"))}}),s("b-table",{ref:"archetypesTable",attrs:{data:t.archetypesTableData,"checked-rows":t.archetypes,"show-detail-icon":!0,"is-row-checkable":function(t){return!0!==t.required},checkable:"",detailed:""},on:{"update:checkedRows":function(e){t.archetypes=e},"update:checked-rows":function(e){t.archetypes=e},"check-all":t.checkAllArchetypes},scopedSlots:t._u([{key:"default",fn:function(e){return[s("b-table-column",{attrs:{label:t.$t("story.archetype"),field:"name",width:"180"}},[s("a",{on:{click:function(s){return t.$refs.archetypesTable.toggleDetails(e.row)}}},[t._v("\n                "+t._s(e.row.name)+"\n              ")])]),s("b-table-column",{attrs:{label:t.$t("story.character"),field:"character"}},[s("b-field",{attrs:{type:{"is-danger":t.archetypes.includes(e.row)&&""===e.row.character&&!t.archetypesAreValid},message:[t.archetypes.includes(e.row)&&""===e.row.character&&!t.archetypesAreValid?t.$t("default.error.field.is.required"):""]}},[s("b-input",{model:{value:e.row.character,callback:function(s){t.$set(e.row,"character","string"===typeof s?s.trim():s)},expression:"props.row.character"}})],1)],1)]}},{key:"detail",fn:function(e){return[t._v("\n            "+t._s(e.row.description)+"\n          ")]}}])})],1),s("div",{directives:[{name:"show",rawName:"v-show",value:3===t.currentStep,expression:"currentStep === 3"}]},[s("h1",{staticClass:"is-size-4 m-b-2"},[t._v("\n          "+t._s(t.$t("view.story.create.form.title.stage"))+"\n        ")]),s("p",{staticClass:"m-b-4"},[t._v("\n          "+t._s(t.$t("view.story.create.form.description.stage"))+"\n        ")]),s("b-table",{ref:"stagesTable",attrs:{data:t.stagesTableData,"checked-rows":t.stages,"show-detail-icon":!0,"is-row-checkable":function(t){return!0!==t.required},checkable:"",detailed:""},on:{"update:checkedRows":function(e){t.stages=e},"update:checked-rows":function(e){t.stages=e},"check-all":t.checkAllStages},scopedSlots:t._u([{key:"default",fn:function(e){return[s("b-table-column",{attrs:{label:t.$t("stage.number"),numeric:!0,field:"number"}},[t._v("\n              "+t._s(e.row.number)+"\n            ")]),s("b-table-column",{attrs:{label:t.$t("stage.label"),field:"name"}},[s("a",{on:{click:function(s){return t.$refs.stagesTable.toggleDetails(e.row)}}},[t._v("\n                "+t._s(e.row.name)+"\n              ")])]),s("b-table-column",{attrs:{label:t.$t("stage.description"),field:"description"}},[t._v("\n              "+t._s(e.row.description)+"\n            ")])]}},{key:"detail",fn:function(e){return[s("div",{staticClass:"columns"},[s("div",{staticClass:"column"},[s("div",{staticClass:"content"},[s("p",[t._v(t._s(t.$t("stage.contex")))]),s("ul",t._l(e.row.context,function(e){return s("li",{key:e},[t._v("\n                      "+t._s(e)+"\n                    ")])}),0)])]),s("div",{staticClass:"column"},[s("div",{staticClass:"content"},[s("p",[t._v(t._s(t.$t("stage.keyPhrase")))]),s("ul",t._l(e.row.keyPhrases,function(e){return s("li",{key:e},[t._v("\n                      "+t._s(e)+"\n                    ")])}),0)])])])]}}])})],1),s("div",{staticClass:"level m-t-3"},[s("div",{staticClass:"level-left"},[s("div",{staticClass:"level-item"},[t.currentStep>0?s("b-button",{attrs:{rounded:""},on:{click:t.previousStep}},[s("vue-fontawesome",{attrs:{icon:"chevron-left"}}),t._v("\n              "+t._s(t.$t("default.label.backward"))+"\n            ")],1):t._e()],1)]),s("div",{staticClass:"level-right"},[s("div",{staticClass:"level-item"},[t.currentStep<=2?s("b-button",{attrs:{type:"is-primary",rounded:""},on:{click:t.nextStep}},[t._v("\n              "+t._s(t.$t("default.label.forward"))+"\n              "),s("vue-fontawesome",{attrs:{icon:"chevron-right"}})],1):s("b-button",{attrs:{type:"is-primary",rounded:""},on:{click:t.register}},[t._v("\n              "+t._s(t.$t("default.label.register"))+"\n            ")])],1)])])])])])},a=[],i=(s("ac6a"),s("96cf"),s("3b8d")),n=s("b5ae"),o=s("bc3a"),l=s.n(o),c=s("0517"),u={mixins:[c["a"]],data:function(){return{title:"",objective:"",keywords:[],authors:[],archetypes:[],stages:[],filteredUsers:[],leader:{},reviewers:[],storytellers:[],currentStep:0,archetypesTableData:[],archetypesAreValid:!0,stagesTableData:[]}},validations:{title:{required:n["required"]}},methods:{previousStep:function(){this.currentStep>0&&(this.archetypesAreValid=!0,this.currentStep--)},nextStep:function(){0===this.currentStep&&this.$v.title.$touch(),2===this.currentStep&&this.validateArchetypes(),!this.$v.$invalid&&this.archetypesAreValid&&this.currentStep<=2&&this.currentStep++},register:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,this.$v.$invalid||!this.archetypesAreValid||3!==this.currentStep){t.next=7;break}return this.$store.dispatch("loading/activate"),t.next=5,l.a.post("/stories",{title:this.title,objective:this.objective,keywords:this.keywords,authors:this.authors,archetypes:this.archetypes,stages:this.stages});case 5:this.$store.dispatch("loading/deactivate"),this.$router.push({name:"storyList"});case 7:t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),this.errorHandler(t.t0.response);case 12:case"end":return t.stop()}},t,this,[[0,9]])}));function e(){return t.apply(this,arguments)}return e}(),getUsers:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(e){var s,r,a,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,s=e.length>0?"/users/name/".concat(e):"/users",t.next=4,l.a.get(s);case 4:r=t.sent,a=r.data,this.filteredUsers=a.filter(function(t){return!i.authors.some(function(e){return e.user===t._id})}),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),this.userList=[];case 12:case"end":return t.stop()}},t,this,[[0,9]])}));function e(e){return t.apply(this,arguments)}return e}(),addReviewer:function(t){this.authors.push({user:t._id,role:1})},addStoryteller:function(t){this.authors.push({user:t._id,role:2})},removeAuthor:function(t){this.authors=this.authors.filter(function(e){return e.user!==t._id})},checkAllArchetypes:function(t){var e=this.archetypesTableData.filter(function(t){return!0===t.required});t.push.apply(t,e)},validateArchetypes:function(){var t=this;this.archetypesAreValid=!0,this.archetypes.forEach(function(e){""===e.character&&(t.archetypesAreValid=!1)})},checkAllStages:function(t){var e=this.stagesTableData.filter(function(t){return!0===t.required});t.push.apply(t,e)}},created:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){var e,s,r,a,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.leader={_id:this.$session.get("userId"),name:this.$session.get("userName")},this.authors.push({user:this.leader._id,role:0}),t.prev=2,t.next=5,l.a.get("/archetypes");case 5:return e=t.sent,this.archetypesTableData=e.data,this.archetypes=this.archetypesTableData.filter(function(t){return!0===t.required}),t.next=10,l.a.get("/stages");case 10:return s=t.sent,this.stagesTableData=s.data,this.stages=this.stagesTableData.filter(function(t){return!0===t.required}),t.next=15,l.a.get("/users");case 15:r=t.sent,a=r.data,this.filteredUsers=a.filter(function(t){return!i.authors.some(function(e){return e.user===t._id})}),t.next=23;break;case 20:t.prev=20,t.t0=t["catch"](2),console.log(t.t0);case 23:case"end":return t.stop()}},t,this,[[2,20]])}));function e(){return t.apply(this,arguments)}return e}()},d=u,p=s("2877"),h=Object(p["a"])(d,r,a,!1,null,null,null);e["default"]=h.exports},a473:function(t,e,s){},b86b:function(t,e,s){t.exports=s.p+"img/no-data.cb61ac4f.svg"},c15d:function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"section"},[s("div",{staticClass:"container"},[s("div",{staticClass:"level"},[s("div",{staticClass:"level-left"},[s("div",{staticClass:"level-item"},[s("h1",{staticClass:"title"},[t._v("\n            "+t._s(t.$tc("story.label",2))+"\n          ")])])]),s("div",{staticClass:"level-right"},[s("div",{staticClass:"level-item"},[s("router-link",{staticClass:"button is-primary is-rounded",attrs:{to:{name:"storyCreate"}}},[t._v("\n            "+t._s(t.$t("default.label.create",{arg:t.$tc("story.label",1)}))+"\n          ")])],1)])]),s("b-tabs",{attrs:{type:"is-boxed"},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[s("b-tab-item",{attrs:{label:t.$tc("default.label.my.female",2,{arg:t.$tc("story.label",2)})}},[s("b-loading",{staticStyle:{height:"250px"},attrs:{"is-full-page":!1,active:t.isLoading,"can-cancel":!0},on:{"update:active":function(e){t.isLoading=e}}}),t.userStories.length>0&&!t.isLoading?s("story-list",{attrs:{stories:t.userStories}}):t._e(),0!==t.userStories.length||t.isLoading?t._e():s("story-list-empty",{attrs:{message:t.$t("view.story.list.empty.user.stories")}})],1),s("b-tab-item",{attrs:{label:t.$t("default.label.all.female",{arg:t.$tc("story.label",2)})}},[s("b-loading",{staticStyle:{height:"250px"},attrs:{"is-full-page":!1,active:t.isLoading,"can-cancel":!0},on:{"update:active":function(e){t.isLoading=e}}}),t.stories.length>0&&!t.isLoading?s("story-list",{attrs:{stories:t.stories}}):t._e(),0!==t.stories.length||t.isLoading?t._e():s("story-list-empty",{attrs:{message:t.$t("view.story.list.empty.stories")}})],1)],1)],1)])},a=[],i=(s("96cf"),s("3b8d")),n=s("bc3a"),o=s.n(n),l=s("0517"),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",t._l(t.stories,function(e){return s("b-collapse",{key:e._id,staticClass:"card m-b-3",attrs:{open:!1},scopedSlots:t._u([{key:"trigger",fn:function(r){return s("div",{staticClass:"card-header",attrs:{role:"button"}},[s("p",{staticClass:"card-header-title"},[t._v("\n        "+t._s(e.title)+"\n      ")]),s("a",{staticClass:"card-header-icon"},[s("b-icon",{attrs:{icon:r.open?"caret-up":"caret-down"}})],1)])}}],null,!0)},[e.objective?s("div",{staticClass:"card-content"},[s("div",{staticClass:"content"},[t._v("\n        "+t._s(e.objective)+"\n\n        "),s("b-taglist",{staticClass:"m-t-3"},t._l(e.keywords,function(e){return s("b-tag",{key:e,attrs:{type:"is-secondary",rounded:""}},[t._v("\n            "+t._s(e)+"\n          ")])}),1)],1)]):t._e(),s("footer",{staticClass:"card-footer"},[s("router-link",{staticClass:"card-footer-item has-background-primary has-text-white",attrs:{to:{name:"storyView",params:{storyId:e._id}}}},[t._v("\n        "+t._s(t.$t("default.label.view"))+"\n      ")]),t.isLeader(e.authors)?s("a",{staticClass:"card-footer-item has-background-primary has-text-white",attrs:{href:"#"}},[t._v("\n        "+t._s(t.$t("default.label.edit",{arg:""}))+"\n      ")]):t._e(),t.isLeader(e.authors)?s("a",{staticClass:"card-footer-item has-background-danger has-text-white",attrs:{href:"#"}},[t._v("\n        "+t._s(t.$t("default.label.delete"))+"\n      ")]):t._e()],1)])}),1)},u=[],d=s("e173"),p={mixins:[d["a"]],props:["stories"]},h=p,v=s("2877"),f=Object(v["a"])(h,c,u,!1,null,null,null),b=f.exports,m=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t._m(0),s("div",{staticClass:"columns"},[s("div",{staticClass:"column is-half is-offset-one-quarter"},[s("p",{staticClass:"is-size-4 has-text-centered"},[t._v("\n        "+t._s(t.message)+"\n      ")]),s("div",{staticClass:"has-text-centered m-t-3"},[s("router-link",{staticClass:"button is-primary is-rounded",attrs:{to:{name:"storyCreate"}}},[t._v("\n          "+t._s(t.$t("default.label.create",{arg:t.$tc("story.label",1)}))+"\n        ")])],1)])])])},y=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"columns"},[r("div",{staticClass:"column is-4 is-offset-4"},[r("figure",{staticClass:"image"},[r("img",{attrs:{src:s("b86b")}})])])])}],g={props:["message"]},_=g,w=Object(v["a"])(_,m,y,!1,null,null,null),$=w.exports,k={mixins:[l["a"]],components:{StoryList:b,StoryListEmpty:$},data:function(){return{activeTab:0,isLoading:!1,userStories:[],stories:[]}},created:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){var e,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.isLoading=!0,t.prev=1,t.next=4,o.a.get("/stories");case 4:return e=t.sent,this.stories=e.data,t.next=8,o.a.get("/stories/user/".concat(this.$session.get("userId")));case 8:s=t.sent,this.userStories=s.data,this.isLoading=!1,t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](1),this.errorHandler(t.t0.response);case 16:case"end":return t.stop()}},t,this,[[1,13]])}));function e(){return t.apply(this,arguments)}return e}()},C=k,x=Object(v["a"])(C,r,a,!1,null,null,null);e["default"]=x.exports},f474:function(t,e,s){"use strict";var r=s("a473"),a=s.n(r);a.a}}]);
//# sourceMappingURL=story.d68a15b4.js.map